import bpy
import os
import json
import DTB.DtbOperators
import DTB.DataBase

dtu = DTB.DataBase.DtuLoader()
DTB.DtbOperators.IMP_OT_FBX.non_interactive_mode = 1
DTB.DazRigBlend.DazRigBlend.non_interactive_mode = 1

# edit next line to set location of import list - currently only supports one .dtu file
with open('C:/Users/darre/Documents/Daz_Import_Json_List.txt','r') as data:

    dtu_dict = json.load(data)
    
    for import_files in dtu_dict['import_files']:
        DTU_File = import_files['DTU_File']
        output_path = import_files['Output path']
        blend_file_name = import_files['.blend_file_name']   
        print (DTU_File)
        print (output_path)
        print (blend_file_name)        

        DTB.DtbOperators.IMP_OT_FBX.non_interactive_mode_address = (DTU_File)

        outputfile = os.path.join(output_path, blend_file_name+".blend")

        bpy.ops.import_dtb.fbx()

        asset_name = dtu.get_asset_name()

        print (str(asset_name))

        bpy.ops.wm.save_as_mainfile(filepath=outputfile)

        bpy.ops.wm.read_homefile(app_template="")

data.close()
